{"ast":null,"code":"\"use strict\";\n/**\r\n * Copyright (c) Microsoft Corporation\r\n *  All Rights Reserved\r\n *  MIT License\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of this\r\n * software and associated documentation files (the 'Software'), to deal in the Software\r\n * without restriction, including without limitation the rights to use, copy, modify,\r\n * merge, publish, distribute, sublicense, and/or sell copies of the Software, and to\r\n * permit persons to whom the Software is furnished to do so, subject to the following\r\n * conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be\r\n * included in all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,\r\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS\r\n * OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\r\n * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT\r\n * OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar Constants_1 = require(\"./Constants\");\n\nvar AccessTokenCacheItem_1 = require(\"./AccessTokenCacheItem\");\n/*\r\n * @hidden\r\n */\n\n\nvar Storage =\n/** @class */\nfunction () {\n  function Storage(cacheLocation) {\n    if (Storage._instance) {\n      return Storage._instance;\n    }\n\n    this._cacheLocation = cacheLocation;\n    this._localStorageSupported = typeof window[this._cacheLocation] !== \"undefined\" && window[this._cacheLocation] != null;\n    this._sessionStorageSupported = typeof window[cacheLocation] !== \"undefined\" && window[cacheLocation] != null;\n    Storage._instance = this;\n\n    if (!this._localStorageSupported && !this._sessionStorageSupported) {\n      throw new Error(\"localStorage and sessionStorage not supported\");\n    }\n\n    return Storage._instance;\n  } // add value to storage\n\n\n  Storage.prototype.setItem = function (key, value) {\n    if (window[this._cacheLocation]) {\n      window[this._cacheLocation].setItem(key, value);\n    } else {\n      throw new Error(\"localStorage and sessionStorage are not supported\");\n    }\n  }; // get one item by key from storage\n\n\n  Storage.prototype.getItem = function (key) {\n    if (window[this._cacheLocation]) {\n      return window[this._cacheLocation].getItem(key);\n    } else {\n      throw new Error(\"localStorage and sessionStorage are not supported\");\n    }\n  }; // remove value from storage\n\n\n  Storage.prototype.removeItem = function (key) {\n    if (window[this._cacheLocation]) {\n      return window[this._cacheLocation].removeItem(key);\n    } else {\n      throw new Error(\"localStorage and sessionStorage are not supported\");\n    }\n  }; // clear storage (remove all items from it)\n\n\n  Storage.prototype.clear = function () {\n    if (window[this._cacheLocation]) {\n      return window[this._cacheLocation].clear();\n    } else {\n      throw new Error(\"localStorage and sessionStorage are not supported\");\n    }\n  };\n\n  Storage.prototype.getAllAccessTokens = function (clientId, userIdentifier) {\n    var results = [];\n    var accessTokenCacheItem;\n    var storage = window[this._cacheLocation];\n\n    if (storage) {\n      var key = void 0;\n\n      for (key in storage) {\n        if (storage.hasOwnProperty(key)) {\n          if (key.match(clientId) && key.match(userIdentifier)) {\n            var value = this.getItem(key);\n\n            if (value) {\n              accessTokenCacheItem = new AccessTokenCacheItem_1.AccessTokenCacheItem(JSON.parse(key), JSON.parse(value));\n              results.push(accessTokenCacheItem);\n            }\n          }\n        }\n      }\n    } else {\n      throw new Error(\"localStorage and sessionStorage are not supported\");\n    }\n\n    return results;\n  };\n\n  Storage.prototype.removeAcquireTokenEntries = function (authorityKey, acquireTokenUserKey) {\n    var storage = window[this._cacheLocation];\n\n    if (storage) {\n      var key = void 0;\n\n      for (key in storage) {\n        if (storage.hasOwnProperty(key)) {\n          if (authorityKey != \"\" && key.indexOf(authorityKey) > -1 || acquireTokenUserKey != \"\" && key.indexOf(acquireTokenUserKey) > -1) {\n            this.removeItem(key);\n          }\n        }\n      }\n    } else {\n      throw new Error(\"localStorage and sessionStorage are not supported\");\n    }\n  };\n\n  Storage.prototype.resetCacheItems = function () {\n    var storage = window[this._cacheLocation];\n\n    if (storage) {\n      var key = void 0;\n\n      for (key in storage) {\n        if (storage.hasOwnProperty(key) && key.indexOf(Constants_1.Constants.msal) !== -1) {\n          this.setItem(key, \"\");\n        }\n\n        if (storage.hasOwnProperty(key) && key.indexOf(Constants_1.Constants.renewStatus) !== -1) this.removeItem(key);\n      }\n    } else {\n      throw new Error(\"localStorage and sessionStorage are not supported\");\n    }\n  };\n\n  return Storage;\n}();\n\nexports.Storage = Storage;","map":{"version":3,"sources":["../src/Storage.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\r\n/**\r\n * Copyright (c) Microsoft Corporation\r\n *  All Rights Reserved\r\n *  MIT License\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of this\r\n * software and associated documentation files (the 'Software'), to deal in the Software\r\n * without restriction, including without limitation the rights to use, copy, modify,\r\n * merge, publish, distribute, sublicense, and/or sell copies of the Software, and to\r\n * permit persons to whom the Software is furnished to do so, subject to the following\r\n * conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be\r\n * included in all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,\r\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS\r\n * OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\r\n * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT\r\n * OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Constants_1 = require(\"./Constants\");\r\nvar AccessTokenCacheItem_1 = require(\"./AccessTokenCacheItem\");\r\n/*\r\n * @hidden\r\n */\r\nvar Storage = /** @class */ (function () {\r\n    function Storage(cacheLocation) {\r\n        if (Storage._instance) {\r\n            return Storage._instance;\r\n        }\r\n        this._cacheLocation = cacheLocation;\r\n        this._localStorageSupported = typeof window[this._cacheLocation] !== \"undefined\" && window[this._cacheLocation] != null;\r\n        this._sessionStorageSupported = typeof window[cacheLocation] !== \"undefined\" && window[cacheLocation] != null;\r\n        Storage._instance = this;\r\n        if (!this._localStorageSupported && !this._sessionStorageSupported) {\r\n            throw new Error(\"localStorage and sessionStorage not supported\");\r\n        }\r\n        return Storage._instance;\r\n    }\r\n    // add value to storage\r\n    Storage.prototype.setItem = function (key, value) {\r\n        if (window[this._cacheLocation]) {\r\n            window[this._cacheLocation].setItem(key, value);\r\n        }\r\n        else {\r\n            throw new Error(\"localStorage and sessionStorage are not supported\");\r\n        }\r\n    };\r\n    // get one item by key from storage\r\n    Storage.prototype.getItem = function (key) {\r\n        if (window[this._cacheLocation]) {\r\n            return window[this._cacheLocation].getItem(key);\r\n        }\r\n        else {\r\n            throw new Error(\"localStorage and sessionStorage are not supported\");\r\n        }\r\n    };\r\n    // remove value from storage\r\n    Storage.prototype.removeItem = function (key) {\r\n        if (window[this._cacheLocation]) {\r\n            return window[this._cacheLocation].removeItem(key);\r\n        }\r\n        else {\r\n            throw new Error(\"localStorage and sessionStorage are not supported\");\r\n        }\r\n    };\r\n    // clear storage (remove all items from it)\r\n    Storage.prototype.clear = function () {\r\n        if (window[this._cacheLocation]) {\r\n            return window[this._cacheLocation].clear();\r\n        }\r\n        else {\r\n            throw new Error(\"localStorage and sessionStorage are not supported\");\r\n        }\r\n    };\r\n    Storage.prototype.getAllAccessTokens = function (clientId, userIdentifier) {\r\n        var results = [];\r\n        var accessTokenCacheItem;\r\n        var storage = window[this._cacheLocation];\r\n        if (storage) {\r\n            var key = void 0;\r\n            for (key in storage) {\r\n                if (storage.hasOwnProperty(key)) {\r\n                    if (key.match(clientId) && key.match(userIdentifier)) {\r\n                        var value = this.getItem(key);\r\n                        if (value) {\r\n                            accessTokenCacheItem = new AccessTokenCacheItem_1.AccessTokenCacheItem(JSON.parse(key), JSON.parse(value));\r\n                            results.push(accessTokenCacheItem);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            throw new Error(\"localStorage and sessionStorage are not supported\");\r\n        }\r\n        return results;\r\n    };\r\n    Storage.prototype.removeAcquireTokenEntries = function (authorityKey, acquireTokenUserKey) {\r\n        var storage = window[this._cacheLocation];\r\n        if (storage) {\r\n            var key = void 0;\r\n            for (key in storage) {\r\n                if (storage.hasOwnProperty(key)) {\r\n                    if ((authorityKey != \"\" && key.indexOf(authorityKey) > -1) || (acquireTokenUserKey != \"\" && key.indexOf(acquireTokenUserKey) > -1)) {\r\n                        this.removeItem(key);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            throw new Error(\"localStorage and sessionStorage are not supported\");\r\n        }\r\n    };\r\n    Storage.prototype.resetCacheItems = function () {\r\n        var storage = window[this._cacheLocation];\r\n        if (storage) {\r\n            var key = void 0;\r\n            for (key in storage) {\r\n                if (storage.hasOwnProperty(key) && key.indexOf(Constants_1.Constants.msal) !== -1) {\r\n                    this.setItem(key, \"\");\r\n                }\r\n                if (storage.hasOwnProperty(key) && key.indexOf(Constants_1.Constants.renewStatus) !== -1)\r\n                    this.removeItem(key);\r\n            }\r\n        }\r\n        else {\r\n            throw new Error(\"localStorage and sessionStorage are not supported\");\r\n        }\r\n    };\r\n    return Storage;\r\n}());\r\nexports.Storage = Storage;\r\n//# sourceMappingURL=Storage.js.map"]},"metadata":{},"sourceType":"script"}